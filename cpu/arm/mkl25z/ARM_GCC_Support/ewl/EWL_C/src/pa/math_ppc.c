/* EWL
 * Copyright © 1995-2007 Freescale Corporation.  All rights reserved.
 *
 * $Date: 2010/04/27 13:22:30 $
 * $Revision: 1.6 $
 */

/*
 * Define _EWL_INLINE to be a weak symbol. This is used by
 * cmath so that the symbols will be defined inside
 * EWL, as well as being available as an inline for the
 * user. Also see ctype.c for another example of this
 */


/*	force definitions to be generated */
/*lint -e960 required to build */
#undef _EWL_USE_INLINE
#undef _EWL_INLINE
#undef _EWL_MATH_CDECL

#define _EWL_USE_INLINE 	1

#if _lint
#define _EWL_INLINE
#else
#ifdef _GCCPORT_
#define _EWL_INLINE 		_EWL_IMP_EXP_C __attribute__((weak))
#else
#define _EWL_INLINE 		_EWL_IMP_EXP_C __declspec(weak)
#endif
#endif /* _lint */

/*	special calling convention for math lib? */
#define _EWL_MATH_CDECL 	_EWL_CDECL
/*lint +e960 required to build */

/*	pragmas to control codegen for this library? */

/*	include header and instantiate _EWL_INLINEs as functions */
#include <fdlibm.h>

/*	sqrt tables */

const uint32_t __inv_sqrt_guess[129]={
0x3FFF017Eu,
0x3FFE05ECu,0x3FFD0D3Eu,0x3FFC1764u,0x3FFB2452u,0x3FFA33F9u,
0x3FF9464Eu,0x3FF85B42u,0x3FF772CBu,0x3FF68CDCu,0x3FF5A969u,
0x3FF4C867u,0x3FF3E9CBu,0x3FF30D8Au,0x3FF23399u,0x3FF15BEFu,
0x3FF08681u,0x3FEFB345u,0x3FEEE232u,0x3FEE133Eu,0x3FED4660u,
0x3FEC7B90u,0x3FEBB2C5u,0x3FEAEBF5u,0x3FEA271Au,0x3FE9642Au,
0x3FE8A31Du,0x3FE7E3EDu,0x3FE72691u,0x3FE66B02u,0x3FE5B139u,
0x3FE4F92Eu,0x3FE442DBu,0x3FE38E39u,0x3FE2DB41u,0x3FE229EDu,
0x3FE17A36u,0x3FE0CC16u,0x3FE01F87u,0x3FDF7483u,0x3FDECB04u,
0x3FDE2305u,0x3FDD7C7Fu,0x3FDCD76Eu,0x3FDC33CCu,0x3FDB9193u,
0x3FDAF0BFu,0x3FDA514Au,0x3FD9B330u,0x3FD9166Bu,0x3FD87AF7u,
0x3FD7E0CFu,0x3FD747EEu,0x3FD6B051u,0x3FD619F2u,0x3FD584CDu,
0x3FD4F0DFu,0x3FD45E22u,0x3FD3CC93u,0x3FD33C2Eu,0x3FD2ACEEu,
0x3FD21ED0u,0x3FD191D1u,0x3FD105ECu,0x3FD07B1Du,0x3FCFF162u,
0x3FCF68B6u,0x3FCEE116u,0x3FCE5A7Fu,0x3FCDD4EDu,0x3FCD505Eu,
0x3FCCCCCDu,0x3FCC4A38u,0x3FCBC89Bu,0x3FCB47F4u,0x3FCAC83Fu,
0x3FCA497Au,0x3FC9CBA2u,0x3FC94EB3u,0x3FC8D2ABu,0x3FC85787u,
0x3FC7DD45u,0x3FC763E2u,0x3FC6EB5Au,0x3FC673ACu,0x3FC5FCD6u,
0x3FC586D3u,0x3FC511A3u,0x3FC49D42u,0x3FC429AFu,0x3FC3B6E6u,
0x3FC344E6u,0x3FC2D3ADu,0x3FC26337u,0x3FC1F383u,0x3FC1848Fu,
0x3FC11659u,0x3FC0A8DEu,0x3FC03C1Cu,0x3FBFD012u,0x3FBF64BDu,
0x3FBEFA1Cu,0x3FBE902Cu,0x3FBE26EBu,0x3FBDBE58u,0x3FBD5671u,
0x3FBCEF34u,0x3FBC889Fu,0x3FBC22B1u,0x3FBBBD67u,0x3FBB58C0u,
0x3FBAF4BAu,0x3FBA9154u,0x3FBA2E8Cu,0x3FB9CC60u,0x3FB96ACEu,
0x3FB909D6u,0x3FB8A975u,0x3FB849AAu,0x3FB7EA74u,0x3FB78BD0u,
0x3FB72DBFu,0x3FB6D03Du,0x3FB6734Au,0x3FB616E4u,0x3FB5BB09u,
0x3FB55FBAu,0x3FB504F3u,0x3FB4AAB4u};

const uint32_t __inv_sqrt_guess2[129]={
0x3FB450FCu,
0x3FB39F19u,0x3FB2EF41u,0x3FB2416Au,0x3FB19589u,0x3FB0EB96u,
0x3FB04387u,0x3FAF9D53u,0x3FAEF8F2u,0x3FAE565Cu,0x3FADB587u,
0x3FAD166Cu,0x3FAC7904u,0x3FABDD46u,0x3FAB432Au,0x3FAAAAABu,
0x3FAA13C0u,0x3FA97E62u,0x3FA8EA8Cu,0x3FA85835u,0x3FA7C759u,
0x3FA737F0u,0x3FA6A9F4u,0x3FA61D5Fu,0x3FA5922Cu,0x3FA50855u,
0x3FA47FD3u,0x3FA3F8A2u,0x3FA372BDu,0x3FA2EE1Du,0x3FA26ABEu,
0x3FA1E89Bu,0x3FA167AFu,0x3FA0E7F5u,0x3FA06968u,0x3F9FEC04u,
0x3F9F6FC4u,0x3F9EF4A4u,0x3F9E7AA0u,0x3F9E01B3u,0x3F9D89D9u,
0x3F9D130Eu,0x3F9C9D4Eu,0x3F9C2896u,0x3F9BB4E1u,0x3F9B422Cu,
0x3F9AD073u,0x3F9A5FB2u,0x3F99EFE6u,0x3F99810Cu,0x3F991320u,
0x3F98A61Fu,0x3F983A05u,0x3F97CED0u,0x3F97647Cu,0x3F96FB06u,
0x3F96926Cu,0x3F962AA9u,0x3F95C3BCu,0x3F955DA2u,0x3F94F857u,
0x3F9493D9u,0x3F943026u,0x3F93CD3Au,0x3F936B13u,0x3F9309AFu,
0x3F92A90Bu,0x3F924925u,0x3F91E9F9u,0x3F918B87u,0x3F912DCAu,
0x3F90D0C3u,0x3F90746Du,0x3F9018C6u,0x3F8FBDCEu,0x3F8F6381u,
0x3F8F09DDu,0x3F8EB0E0u,0x3F8E5889u,0x3F8E00D5u,0x3F8DA9C2u,
0x3F8D534Fu,0x3F8CFD79u,0x3F8CA83Fu,0x3F8C539Fu,0x3F8BFF97u,
0x3F8BAC25u,0x3F8B5948u,0x3F8B06FDu,0x3F8AB544u,0x3F8A641Au,
0x3F8A137Du,0x3F89C36Du,0x3F8973E8u,0x3F8924ECu,0x3F88D677u,
0x3F888889u,0x3F883B1Eu,0x3F87EE37u,0x3F87A1D2u,0x3F8755EDu,
0x3F870A87u,0x3F86BF9Eu,0x3F867532u,0x3F862B40u,0x3F85E1C7u,
0x3F8598C7u,0x3F85503Eu,0x3F85082Au,0x3F84C08Bu,0x3F84795Fu,
0x3F8432A5u,0x3F83EC5Cu,0x3F83A682u,0x3F836117u,0x3F831C1Au,
0x3F82D788u,0x3F829362u,0x3F824FA6u,0x3F820C52u,0x3F81C967u,
0x3F8186E2u,0x3F8144C4u,0x3F81030Au,0x3F80C1B4u,0x3F8080C1u,
0x3F804030u,0x3F800000u,0x3F7F8060u};

const uint32_t __two_inv_x[129]={
0x407E03F8u,
0x407C0FC1u,0x407A232Du,0x40783E10u,0x4076603Eu,0x4074898Du,0x4072B9D6u,0x4070F0F1u,0x406F2EB7u,
0x406D7304u,0x406BBDB3u,0x406A0EA1u,0x406865ACu,0x4066C2B4u,0x40652598u,0x40638E39u,0x4061FC78u,
0x40607038u,0x405EE95Cu,0x405D67C9u,0x405BEB62u,0x405A740Eu,0x405901B2u,0x40579436u,0x40562B81u,
0x4054C77Bu,0x4053680Du,0x40520D21u,0x4050B6A0u,0x404F6475u,0x404E168Au,0x404CCCCDu,0x404B8728u,
0x404A4588u,0x404907DAu,0x4047CE0Cu,0x4046980Cu,0x404565C8u,0x40443730u,0x40430C31u,0x4041E4BCu,
0x4040C0C1u,0x403FA030u,0x403E82FAu,0x403D6910u,0x403C5264u,0x403B3EE7u,0x403A2E8Cu,0x40392144u,
0x40381703u,0x40370FBBu,0x40360B61u,0x403509E7u,0x40340B41u,0x40330F63u,0x40321643u,0x40311FD4u,
0x40302C0Bu,0x402F3ADEu,0x402E4C41u,0x402D602Bu,0x402C7692u,0x402B8F6Au,0x402AAAABu,0x4029C84Au,
0x4028E83Fu,0x40280A81u,0x40272F05u,0x402655C4u,0x40257EB5u,0x4024A9CFu,0x4023D70Au,0x4023065Eu,
0x402237C3u,0x40216B31u,0x4020A0A1u,0x401FD80Au,0x401F1166u,0x401E4CADu,0x401D89D9u,0x401CC8E1u,
0x401C09C1u,0x401B4C70u,0x401A90E8u,0x4019D723u,0x40191F1Au,0x401868C8u,0x4017B426u,0x4017012Eu,
0x40164FDAu,0x4015A025u,0x4014F209u,0x40144581u,0x40139A86u,0x4012F114u,0x40124925u,0x4011A2B4u,
0x4010FDBCu,0x40105A38u,0x400FB824u,0x400F177Au,0x400E7835u,0x400DDA52u,0x400D3DCBu,0x400CA29Cu,
0x400C08C1u,0x400B7034u,0x400AD8F3u,0x400A42F8u,0x4009AE41u,0x40091AC7u,0x40088889u,0x4007F781u,
0x400767ABu,0x4006D905u,0x40064B8Au,0x4005BF37u,0x40053408u,0x4004A9FAu,0x40042108u,0x40039930u,
0x4003126Fu,0x40028CC0u,0x40020821u,0x4001848Eu,0x40010204u,0x40008081u,0x40000000u,0x3FFF00FFu,
};
const uint32_t __inv_x_sqr[129]={
0x407C0BE0u,
0x40782F05u,0x407468B9u,0x4070B84Du,0x406D1D1Bu,0x4069967Fu,0x406623E0u,0x4062C4A7u,0x405F7842u,
0x405C3E29u,0x405915D3u,0x4055FEBFu,0x4052F871u,0x40500270u,0x404D1C48u,0x404A4588u,0x40477DC4u,
0x4044C493u,0x40421991u,0x403F7C5Bu,0x403CEC92u,0x403A69DCu,0x4037F3E0u,0x40358A48u,0x40332CC3u,
0x4030DAFFu,0x402E94B0u,0x402C598Bu,0x402A2946u,0x4028039Cu,0x4025E849u,0x4023D70Au,0x4021CFA0u,
0x401FD1CDu,0x401DDD55u,0x401BF1FDu,0x401A0F8Eu,0x401835CFu,0x4016648Du,0x40149B93u,0x4012DAB0u,
0x401121B2u,0x400F706Cu,0x400DC6AEu,0x400C244Du,0x400A891Du,0x4008F4F5u,0x400767ABu,0x4005E119u,
0x40046116u,0x4002E77Fu,0x4001742Eu,0x40000700u,0x3FFD3FA7u,0x3FFA7D0Cu,0x3FF7C5EEu,0x3FF51A0Du,
0x3FF2792Du,0x3FEFE311u,0x3FED577Fu,0x3FEAD63Du,0x3FE85F15u,0x3FE5F1D0u,0x3FE38E39u,0x3FE1341Eu,
0x3FDEE34Cu,0x3FDC9B93u,0x3FDA5CC3u,0x3FD826AEu,0x3FD5F928u,0x3FD3D404u,0x3FD1B717u,0x3FCFA238u,
0x3FCD953Eu,0x3FCB9001u,0x3FC9925Bu,0x3FC79C25u,0x3FC5AD3Cu,0x3FC3C579u,0x3FC1E4BCu,0x3FC00AE1u,
0x3FBE37C6u,0x3FBC6B4Cu,0x3FBAA552u,0x3FB8E5B9u,0x3FB72C62u,0x3FB57931u,0x3FB3CC07u,0x3FB224C9u,
0x3FB0835Au,0x3FAEE79Fu,0x3FAD517Fu,0x3FABC0DFu,0x3FAA35A6u,0x3FA8AFBBu,0x3FA72F05u,0x3FA5B36Eu,
0x3FA43CDEu,0x3FA2CB3Eu,0x3FA15E79u,0x3F9FF679u,0x3F9E9327u,0x3F9D3471u,0x3F9BDA41u,0x3F9A8484u,
0x3F993326u,0x3F97E614u,0x3F969D3Cu,0x3F95588Bu,0x3F9417EFu,0x3F92DB58u,0x3F91A2B4u,0x3F906DF2u,
0x3F8F3D01u,0x3F8E0FD3u,0x3F8CE657u,0x3F8BC07Du,0x3F8A9E36u,0x3F897F75u,0x3F88642Au,0x3F874C46u,
0x3F8637BDu,0x3F852680u,0x3F841883u,0x3F830DB7u,0x3F820610u,0x3F810182u,0x3F800000u,0x3F7E02FCu,
};

_EWL_BEGIN_NAMESPACE_STD
_EWL_BEGIN_EXTERN_C

#if !_EWL_ONLY_SINGLE_PRECISION_MATH_LIB
#if _EWL_C99 || _EWL_C99_MATH_LEAK

_EWL_IMP_EXP_C  f64_t      _EWL_MATH_CDECL log2(f64_t x)
{
	static const uint32_t f[2] = {0x3ff71547u, 0x652b82feu};
	MISRA_EXCEPTION_RULE_1_2c()
	MISRA_EXCEPTION_RULE_11_4()
	f64_t res = log(x) * *(f64_t*)f;
	return res;
}

_EWL_IMP_EXP_C  f64_t      _EWL_MATH_CDECL nan(const char_t* x)
{
	MISRA_QUIET_UNUSED_ARGS()
	f64_t res = NaN;
	return res;
}

_EWL_INLINE f64_t  _EWL_MATH_CDECL scalbln (f64_t x, int32_t n)
{
	return ldexp(x,(int_t)n);
}


#endif


_EWL_IMP_EXP_C  f64_t      _EWL_MATH_CDECL scalbn(f64_t x, int_t y)
{
	return ldexp(x,y);
}

#else

#if _EWL_C99 || _EWL_C99_MATH_LEAK
_EWL_IMP_EXP_C  f32_t      _EWL_MATH_CDECL log2f(f32_t x)
{
	static const f32_t _ln2 = 0.6931471805599453094172321F;
	f32_t res = logf(x)/_ln2;
	return res;
}
#endif /* _EWL_C99 || _EWL_C99_MATH_LEAK */

#endif /* _EWL_ONLY_SINGLE_PRECISION_MATH_LIB */

_EWL_END_EXTERN_C
_EWL_END_NAMESPACE_STD


/*
 * This file replaces all the calls to the single
 * precision functions with their inline counterparts
 * in <cmath>, and <math_ppc.h>
 * By using the _INLINE and __declspec(weak) method
 * above, it allows the user needing the symbol to be
 * defined from previous builds to still get that symbol
 * Users rebuilding, will pick up the inline version.
 * The symbol is only weakly defined in EWL.
 */
